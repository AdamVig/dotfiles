#!/usr/bin/env bash

set -euo pipefail

# Move back to the default branch, pull, prune branches, and remove the previous branch
main() {
  local current_branch
  local default_branch
  current_branch="$(git rev-parse --abbrev-ref HEAD)"
  default_branch="$(get-default-branch origin)"

  if [ "$current_branch" = "$default_branch" ]; then
    echo "error: current branch is default branch, please run again from a different branch"
    return 1
  fi

  git checkout "$default_branch"
  git pull
  git fetch --prune
  git branch --delete "$current_branch"
}
main "$@"
